#
# This is a Shiny web application. You can run the application by clicking
# the 'Run App' button above.
#
# Find out more about building applications with Shiny here:
#
#    http://shiny.rstudio.com/
#

library(shiny)
library(leaflet)
library(shinyWidgets)
library(shinycssloaders)

map_ca <- readRDS("data/ca_vulnerability.rds")
map_iz <- readRDS("data/iz_vulnerability.rds")
map_dz <- readRDS("data/dz_vulnerability.rds")

# Define UI for application that draws a histogram
ui <- fluidPage(
  includeCSS("www/styles.css"),
   # Application title
   titlePanel("Vulnerability of communities to COVID-19"),
      sidebarPanel(
        radioGroupButtons("map_area", 
                          label= "Select a geography level", 
                          choices = c("Council area", "Intermediate zone",  "Data zone"), 
                          status = "primary", justified = TRUE, direction = "vertical")
        ), #sidebar panel bracket
      
      # Show a plot of the generated distribution
      mainPanel(
        withSpinner(leafletOutput("map_vuln", width="100%",height="550px"))
      )#mainpanel bracket
) #fulidpage bracket

# Define server logic required to draw a histogram
server <- function(input, output) {
   
   output$map_vuln <- renderLeaflet({

     if (input$map_area == "Data zone") {
       map_dz
     } else if (input$map_area == "Intermediate zone") {
       map_iz
     } else if (input$map_area == "Council area") {
       map_ca
     }
     
   })
}

# Run the application 
shinyApp(ui = ui, server = server)

